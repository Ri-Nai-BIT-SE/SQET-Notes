# 性能测试 (Performance Testing)

案例题通常会给你一张测试工具生成的图表（比如LoadRunner的图），让你分析系统出了什么问题。

### 测试类型

- **负载测试（Load Testing）**：
  - 确定在各种工作负载下系统的性能
  - 寻找指标变化
  - 测试系统在正常或稍高负载下的表现
- **压力测试（Stress Testing）**：
  - 确定系统的**瓶颈**或**崩溃点**（不可接受的性能点）
  - 测试系统在极限/超负荷下的表现
- **并发性能测试**：
  - 逐渐增加并发用户数
  - 观察系统性能变化

### 关键指标术语（写在卷子上能得分）

*   **并发用户数 (Concurrency)**：系统同一时间承受的用户量。
*   **响应时间 (Response Time)**：用户点一下鼠标到看到结果需要多久（通常"2-5-8原则"，2秒优秀，5秒良好，8秒无法忍受）。
*   **吞吐量 (Throughput)**：单位时间内系统处理的数据量。
*   **资源利用率**：CPU使用率、内存使用率。

### 性能指标

1. **并发用户数**：同时访问系统的用户数量
2. **响应时间**：系统响应请求的时间
3. **吞吐量（Throughput）**：单位时间内处理的请求数
4. **资源利用率**：
   - CPU 占用率
   - 内存占用率
   - 磁盘 I/O
   - 网络带宽

### 负载压力测试实施步骤

1. **计划**：制定测试计划
2. **录制脚本**：录制用户操作脚本
3. **定义场景**：定义测试场景（并发数、持续时间等）
4. **执行**：执行测试
5. **分析结果**：分析测试结果，找出瓶颈

### 测试目的（案例分析题重点）

1. 检测系统性能是否满足 SRS 中的非功能性需求（如响应时间、并发数）
2. 预见系统的负载承受力（峰值、边界）
3. **发现系统瓶颈并进行调优**（最难点）

### 常见"病症"分析（背诵！）

1.  **交易响应时间过长**：
    *   可能是数据库操作耗时
    *   *调优：* 建立索引、优化 SQL、水平分割大表

2.  **CPU瓶颈**：
    *   如果图表中 **CPU利用率持续超过 95%**，说明计算量太大或算法效率低
    *   *调优：* 增加处理器、更换更快 CPU、优化算法
    *   **合理范围是 60%-70%**

3.  **内存瓶颈**：
    *   如果 **内存/缓存点击率持续 < 80%**，瓶颈在内存
    *   如果 **内存占用持续上升，且不下降**（锯齿状向上），说明存在 **内存泄漏 (Memory Leak)**
    *   *调优：* 增加内存、检查代码中未释放的对象

4.  **数据库瓶颈**：
    *   如果CPU和内存都不高，但响应时间特别慢
    *   *调优：* 优化SQL语句、建立索引

### 分段分析方法

*   通过工具分别模拟访问 Web 服务器、应用服务器、数据库
*   通过减法确定慢在哪一段
*   例如：总响应时间 - Web服务器时间 - 应用服务器时间 = 数据库时间

### 案例分析考点

**常见题型**：
- 给出测试工具生成的图表或数据（如 CPU 占用率高）
- 分析系统瓶颈（如 CPU 瓶颈、内存泄漏）
- 提出调优建议

**分析要点**：
- 识别性能瓶颈（CPU、内存、I/O、网络）
- 分析瓶颈原因
- 提出优化方案

**答题技巧**：看着图表里的曲线，那一根线飙高了就说哪里有瓶颈，多写几个专业术语（响应时间、吞吐量、资源利用率）。

### 常见图表分析（案例分析题）

**响应时间曲线**：
- 如果持续上升，说明系统性能下降
- 如果突然飙升，可能是系统达到瓶颈

**CPU利用率**：
- 如果持续>95%，可能是CPU瓶颈
- 如果波动剧烈，可能是算法效率问题

**内存占用**：
- 如果持续上升且不下降，可能是内存泄漏
- 如果达到上限，系统可能崩溃

**吞吐量**：
- 如果下降，说明系统处理能力下降
- 如果达到峰值后下降，说明系统达到瓶颈

> **来源文件**：`output_4_15_3.txt`，`Dec_24.txt`（2025年12月24日课堂录音），`Dec_29.txt`（2025年12月29日课堂录音）